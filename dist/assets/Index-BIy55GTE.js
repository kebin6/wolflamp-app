import{d as P,a as B,r as _,B as S,i as V,k as c,w as f,h as w,m as T,u as M,C as U,P as $,b as F,f as s,t as n,g as C,j as g,l as D,s as b,af as R,ag as E,p as W,z as j,A as z,_ as H}from"./index-CE6aD7Yz.js";import{N as L}from"./Nav-t7JzAWAb.js";import{C as O}from"./Card-DC1qEnvt.js";import{B as q}from"./Button-Dvqetgh8.js";import{P as G}from"./PasswordCard-CRx-B21y.js";import{s as J}from"./toast-B0Skdhi8.js";import{a as K}from"./index-Brt2etDG.js";import{s as Q}from"./function-call-DbDf64If.js";import"./back-CpyWDUeq.js";import"./_commonjsHelpers-Cpj98o6Y.js";const r=d=>(j("data-v-b72a8497"),d=d(),z(),d),X={class:"page-withdraw g-box"},Y={class:"box"},Z={class:"form-box"},ss={class:"label-box"},es={class:"value-box"},ts={class:"input-box"},os=["placeholder"],as={class:"form-box"},ns=r(()=>s("section",{class:"label-box"},"Deposit network",-1)),is={class:"value-box"},ls={class:"input-box"},cs=["value"],rs={class:"form-box"},ds=r(()=>s("section",{class:"label-box"},"Withdrawl amount",-1)),us={class:"value-box"},ps={class:"input-box"},ms={class:"unit"},hs={class:"total"},_s=r(()=>s("section",{class:"hr"},null,-1)),fs={class:"box"},ws={class:"form-box flex"},bs=r(()=>s("section",{class:"label-box"},"Handling fees",-1)),vs={class:"value-box"},xs={class:"text"},Cs={class:"form-box flex"},gs=r(()=>s("section",{class:"label-box"},"Amount received",-1)),As={class:"value-box p-b"},Is={class:"text"},Ns=P({__name:"Index",setup(d){const p=M(),A=U(),i=B(),o=_({withdrawAddress:"",amount:0,password:""}),m=_({amount:0,handingFee:0,receivedAmount:0,totalAmount:0});let l=_(!1);const I=()=>{var e;if(((e=i.user.info)==null?void 0:e.isInit)===2)return b("Please set the password first");if(!o.value.withdrawAddress)return b("Please input address");if(/[\u4e00-\u9fa5]/gi.test(o.value.withdrawAddress))return b("address cannot be in Chinese ");+o.value.amount!=0&&(l.value=!0)},N=async()=>{if(o.value.password)try{let{data:e}=await R(o.value);p.push(`/withdraw/result?id=${e}`)}catch{}},v=async()=>{var u;let e=((u=i.user.info)==null?void 0:u.balance)||0,t=o.value.amount||0;if(!t){o.value.amount=0;return}t>=e&&(o.value.amount=e,t=e);try{J();let{data:a}=await E({amount:t});W(),m.value=a}catch{}},k=()=>{var t;let e=((t=i.user.info)==null?void 0:t.balance)||0;o.value.amount=e,v()},y=async()=>{o.value.withdrawAddress=await K()};return S(A,()=>{var e;((e=i.user.info)==null?void 0:e.isInit)===2&&setTimeout(()=>{Q({message:"Please set the password"}).then(t=>{t==="confirm"&&p.push("/setting/password")}).catch(()=>{p.back()})})},{deep:!0,immediate:!0}),(e,t)=>{const u=$;return F(),V("section",X,[c(L,{title:"Withdraw"}),c(O,{class:"card-withdraw"},{default:f(()=>{var a,x;return[s("section",Y,[s("section",Z,[s("section",ss,n(e.$coinName)+" address",1),s("section",es,[s("section",ts,[C(s("textarea",{"onUpdate:modelValue":t[0]||(t[0]=h=>o.value.withdrawAddress=h),placeholder:`${e.$coinName} address`},null,8,os),[[g,o.value.withdrawAddress]]),s("section",{class:"op",onClick:y},"Paste")])])]),s("section",as,[ns,s("section",is,[s("section",ls,[s("input",{type:"text",value:(a=w(i).user.info)==null?void 0:a.network,disabled:""},null,8,cs)])])]),s("section",rs,[ds,s("section",us,[s("section",ps,[C(s("input",{"onUpdate:modelValue":t[1]||(t[1]=h=>o.value.amount=h),type:"number",placeholder:"Min 0",min:"0",onBlur:v},null,544),[[g,o.value.amount]]),s("section",ms,n(e.$coinName),1),s("section",{class:"op",onClick:k},"Max")])])]),s("section",hs,"Total balanceï¼š"+n((x=w(i).user.info)==null?void 0:x.balance),1)]),_s,s("section",fs,[s("section",ws,[bs,s("section",vs,[s("section",xs,n(m.value.handingFee||0)+" "+n(e.$coinName),1)])]),s("section",Cs,[gs,s("section",As,[s("section",Is,n(m.value.receivedAmount||0)+" "+n(e.$coinName),1)])]),c(q,{type:"p2",class:"btn",onClick:I},{default:f(()=>[D("SUBMIT")]),_:1})])]}),_:1}),c(u,{show:w(l),"onUpdate:show":t[3]||(t[3]=a=>T(l)?l.value=a:l=a),class:"popup"},{default:f(()=>[c(G,{title:"Please enter the <br/> transaction password","btn-text":"CONFIRM",modelValue:o.value.password,"onUpdate:modelValue":t[2]||(t[2]=a=>o.value.password=a),onConfirm:N},null,8,["modelValue"])]),_:1},8,["show"])])}}}),Fs=H(Ns,[["__scopeId","data-v-b72a8497"]]);export{Fs as default};
