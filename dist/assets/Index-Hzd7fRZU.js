import{d as F,a as S,r as p,B as T,i as V,k as c,w as b,h as v,m as $,u as M,C as R,P as U,b as D,f as s,t as n,g,j as A,l as E,s as m,af as W,ag as z,p as j,z as H,A as L,_ as O}from"./index-BDfR2T7Q.js";import{_ as Z}from"./close-MV0GtgYI.js";import{N as q}from"./Nav-DCYi3rhb.js";import{C as G}from"./Card-CJrU-Fbk.js";import{B as J}from"./Button-7n2lWGua.js";import{P as K}from"./PasswordCard-qM5XkEFK.js";import{s as Q}from"./toast-nLkwQMu0.js";import{a as X}from"./index-CrafJq2R.js";import{s as Y}from"./function-call-L9Mob7R3.js";import"./back-CpyWDUeq.js";import"./_commonjsHelpers-Cpj98o6Y.js";const d=u=>(H("data-v-54917808"),u=u(),L(),u),ss={class:"page-withdraw g-box"},es={class:"box"},ts={class:"form-box"},os={class:"label-box"},as={class:"value-box"},ns={class:"input-box"},is=["placeholder"],rs={class:"form-box"},ls=d(()=>s("section",{class:"label-box"},"Deposit network",-1)),cs={class:"value-box"},ds={class:"input-box"},us=["value"],ps={class:"form-box"},ms=d(()=>s("section",{class:"label-box"},"Withdrawl amount",-1)),_s={class:"value-box"},hs={class:"input-box"},ws={class:"unit"},fs={class:"total"},bs=d(()=>s("section",{class:"hr"},null,-1)),vs={class:"box"},xs={class:"form-box flex"},Cs=d(()=>s("section",{class:"label-box"},"Handling fees",-1)),gs={class:"value-box"},As={class:"text"},ks={class:"form-box flex"},Is=d(()=>s("section",{class:"label-box"},"Amount received",-1)),Ns={class:"value-box p-b"},Ps={class:"text"},ys={class:"pwd-pop"},Bs=F({__name:"Index",setup(u){const _=M(),k=R(),i=S(),o=p({withdrawAddress:"",amount:0,password:""}),h=p({amount:0,handingFee:0,receivedAmount:0,totalAmount:0});let r=p(!1);const w=p(),I=()=>{var e;if(((e=i.user.info)==null?void 0:e.isInit)===2)return m("Please set the password first");if(+o.value.amount!=0){if(!o.value.withdrawAddress)return m("Please input address");if(/[\u4e00-\u9fa5]/gi.test(o.value.withdrawAddress))return m("address cannot be in Chinese ");if(!/^[a-zA-Z0-9_]+$/.test(o.value.withdrawAddress))return m("Please input correct address ");r.value=!0}},N=async()=>{var e;if(o.value.password)try{let{data:t}=await W(o.value);_.push(`/withdraw/result?id=${t}`)}catch({error:t,hideToast:l}){t.data.msg==="wrong old transaction password"&&(o.value.password="",(e=w.value)==null||e.errorFn(!0))}},x=async()=>{var l;let e=((l=i.user.info)==null?void 0:l.balance)||0,t=o.value.amount||0;if(!t){o.value.amount=0;return}t>=e&&(o.value.amount=e,t=e);try{Q();let{data:a}=await z({amount:t});j(),h.value=a}catch{}},P=()=>{var t;let e=((t=i.user.info)==null?void 0:t.balance)||0;o.value.amount=e,x()},y=async()=>{o.value.withdrawAddress=await X()};T(k,()=>{var e;((e=i.user.info)==null?void 0:e.isInit)===2&&setTimeout(()=>{Y({message:"Please set the password"}).then(t=>{t==="confirm"&&_.push("/setting/password")}).catch(()=>{_.back()})})},{deep:!0,immediate:!0});const B=()=>{var e;r.value=!1,(e=w.value)==null||e.errorFn(!1),o.value.password=""};return(e,t)=>{const l=U;return D(),V("section",ss,[c(q,{title:"Withdraw"}),c(G,{class:"card-withdraw"},{default:b(()=>{var a,C;return[s("section",es,[s("section",ts,[s("section",os,n(e.$coinName)+" address",1),s("section",as,[s("section",ns,[g(s("textarea",{"onUpdate:modelValue":t[0]||(t[0]=f=>o.value.withdrawAddress=f),placeholder:`${e.$coinName} address`},null,8,is),[[A,o.value.withdrawAddress]]),s("section",{class:"op",onClick:y},"Paste")])])]),s("section",rs,[ls,s("section",cs,[s("section",ds,[s("input",{type:"text",value:(a=v(i).user.info)==null?void 0:a.network,disabled:""},null,8,us)])])]),s("section",ps,[ms,s("section",_s,[s("section",hs,[g(s("input",{"onUpdate:modelValue":t[1]||(t[1]=f=>o.value.amount=f),type:"number",placeholder:"Min 0",min:"0",onBlur:x},null,544),[[A,o.value.amount]]),s("section",ws,n(e.$coinName),1),s("section",{class:"op",onClick:P},"Max")])])]),s("section",fs,"Total balanceï¼š"+n((C=v(i).user.info)==null?void 0:C.balance),1)]),bs,s("section",vs,[s("section",xs,[Cs,s("section",gs,[s("section",As,n(h.value.handingFee||0)+" "+n(e.$coinName),1)])]),s("section",ks,[Is,s("section",Ns,[s("section",Ps,n(h.value.receivedAmount||0)+" "+n(e.$coinName),1)])]),c(J,{type:"p2",class:"btn",onClick:I},{default:b(()=>[E("SUBMIT")]),_:1})])]}),_:1}),c(l,{show:v(r),"onUpdate:show":t[3]||(t[3]=a=>$(r)?r.value=a:r=a),class:"popup"},{default:b(()=>[s("section",ys,[s("img",{src:Z,class:"close",onClick:B}),c(K,{title:"Please enter the <br/> transaction password","btn-text":"CONFIRM",modelValue:o.value.password,"onUpdate:modelValue":t[2]||(t[2]=a=>o.value.password=a),onConfirm:N,tip:"Password error, please re-enter",ref_key:"passwordCardRef",ref:w},null,8,["modelValue"])])]),_:1},8,["show"])])}}}),zs=O(Bs,[["__scopeId","data-v-54917808"]]);export{zs as default};
